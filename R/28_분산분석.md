# 분산분석

- 3개 이상의 집단에 대한 평균 차이를 검증하는 분석 방법
- 가설검정은 F분포를 이용
- t검정에서는 직접적으로 두 집단에 대한 차이를 비교했지만, 3개 이상의 집단을 직접 비교하는 방법은 상당히 복잡하므로 분산분석 이용

- 농작물과 관련된 실험(수확량의 증가, 브료의 효과 등)에서 시작된 실혐계획법에 주로 사용되고 있음



## 분산 분석에서 사용되는 용어

- 종속변수 또는 반응변수

- 독립변수 또는 요인

- 요인수준 또는 처리

  예) 어떤 비료를 사용하는 것이 사과의 수확량 증가에 효과가 있는지 비교

  <img src="C:%5CUsers%5Ckimih%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210303092707724.png" alt="image-20210303092707724" style="zoom: 80%;" />
  - 실헙에 사용할 사과나무는 동일한 품종의 5년생 15그루 비료는 abc 세가지에 대해 5 그루 씩 무작위로 할당하여 나무 당 수확량(X)을 측정한 결과

  - 수확량에 영향을 줄 비료 : 요인

  - 요인을 몇 개의 단위로 구분한 것 : 처리 또는 수준

  - 예에서 요인은 1개 (비료)이고 , 수준은 3 (A, B, C)

  - 요인이 한 개인 분산 분석 : 일원 분산분석

  - 집단간 편차/집단내 편차

    <img src="C:%5CUsers%5Ckimih%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210303092959661.png" alt="image-20210303092959661" style="zoom:80%;" />



## 분산분석에서 F검정과 분산분석표

- 분산분석은 분산의 비율(F 값)로서 검정을 하며 이를 F 검정이라고 함

- F 값을 계산하기 위해 각 변동(분산)을 정리하는 표를 분산분석표

- 오차변동 : 우연에 의해 변동될 수 밖에 없는 것

  <img src="C:%5CUsers%5Ckimih%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210303093616371.png" alt="image-20210303093616371" style="zoom:80%;" />


## 분산분석 종류
### 1. 일원분산분석

- 한 가지 요인을 기준으로 집단 간의 차이를 조사하는 것

- 편의점 종류를 기준으로 고객의 만족도 조사

  <img src="C:%5CUsers%5Ckimih%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210303094410144.png" alt="image-20210303094410144" style="zoom:80%;" />



### 2. 이원 분산분석

- 두 가지 요인을 기준으로 집단 간의 차이를 조사하는 것

- 편의점 종류와 위치를 기준으로 나누고, 편의점에 대한 고객의 만족도 조사

  

### 3. 다원 분산분석

- 세 가지 이상 요인을 기준으로 집단 간의 차이를 조사하는 것

- 편의점 종류와 상권, 본사 국가를 기준으로 편의점에 대한 고객의 만족도 조사

  

### 4. 다변량 분산분석

- 독립변수 1개 이상에 대해 종속변수 2개 이상으로 조사하는 것

- 편의점 종류를 독립변수로  구성하고, 종속변수로 고객의 만족도와 재방문율 2개로 구성하여 조사하는 것



## 분산분석 가정

1. 정규성 : 각 모집단의 반응변수(종속변수)는 정규 분포를 따른다.
2. 등분산성 : 반응변수의 분산은 모든 모집단에서 동일하다.
3. 독립성 : 모집단에서 추출된 표본은 각각 독립적이다.



## R의 formula에서 사용되는 기호

- `~` : 설명변수를 오른쪽에 반응변수를 왼쪽에
  - y ~ A+B+C
- `:` : 변수간 상호작용을 나타냄
  - y ~ A+B+A:B
- `*` : 변수 간 완전 교차를 나타냄
  - y~A`*`B`*`C
  - y~A+B+C+A:B+A:C+B:C+A:B:C
- `^` : 교차하는 변수의 수를 가리킴
  - y~(A+B+C)^2
  - y~A+B+C+A:B+A:C+B:C
- `.` : 모든 나머지 변수들을 가리킴
  - y~.
  - y~A+B+C



## 일원분산분석

가설 설정

- h0 : 편의점별 소비자 만족도에 차이가 없다
- h1 : 편의점별 소비자 만족도에 차이가 있다 (귀무가설 기각)



## 일원 공분산분석

- ANOVA에 하나 또는 둘 이상의 양적 공변량을 포함하는 분석 모델
- 공변량(covariate)
  - 독립변수라기보다 하나의 개념으로서 여러 변수들이 공통적으로 함께 공유하고 있는 변량을 뜻함
  - 종속변수에 대하여 독립변수와 기타 잡음인자들이 공유하는 변량이 됨
  - 종속변수에 영향을 줄 수 있는 잡음인자를 통제하고자 하는 변수
  - 예) 당뇨병 환자에 대하여 혈당 낮추는 5가지 치료법 효능 실험
    - 독립변수 : 치료법
    - 공변량 : 초기 혈당 수치
    - 반응변수 : 한달 후 혈당 수치



## 다변량 분산분석(MONOVA)

- 종속변수가 두 개 이상일 때 세 집단 이상의 평균들으 ㅣ차이를 비교
  - 독립변수는 명목척도(범주형)이고, 종속변수는 간격척도 이상(연속형)
- 가정
  - 관측치는 서로 독립이다.
  - 각 집단의 분산과 공분산행렬이 동일하다
  - 모든 종속변수들은 다변량 정규분포를 따른다.
- 분석절차
  - 종속변수 사이에 상관관계가 있는지 조사
  - 변수들의 기본가정인 다변량정규분포성과 등분산성 조사
- manova()



---

- 귀무가설 : 
  - h0 : 평균이 모두 같다(처리수준에 따라 차이가 없다.) 

  - 대립가설 h1: 다르다(처리 수준에 따라 차이가 있다.)

  - 0.05보다 작으면 귀무가설 기각





## 상관분석

### 연관성 분석

- 조사 대상에서 수집한 자료의 처곧를 기준으로 변수들 간에 어느정도 밀접한 관계가 있는지를 판단하기 위한 분석방법

- 연관성 분석의 분류

  - 사용된 처곧의 종류에 따라 분석 방법이 달라짐
  - 연속형 척도
    - 다른 변수들의 개입 여부에 따라 편상관분석과 피어슨 상관분석으로 구분
  - 범주형 척도
    - 서열척도로 구성된 변수들은 스피어만 서열 상관분석
    - 명목척도로 구성된 변수들은 교차분석

  <img src="C:%5CUsers%5Ckimih%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210303163316324.png" alt="image-20210303163316324" style="zoom:80%;" />

- 두 연속형 변수(구간.비율척도) 사이의 선형관계를 분석
  - 두 변수 간의 상호관계 파악
  - 예) 홈런개수와 연봉의 관계, 아버지의 키와 아들의 키의 관계
- 상관분석의 가정
  - 두 변수 X와 Y의 이변량 정규분포를 따른다
- X와 Y의 상관계수
  - X와Y가 독립이라면 상관계수는 0이다.
  - X, Y가 이변량 정규분포를 하는 경우 상관계수가 0이면 X, Y는 독립이다.



### 산점도(scatter diagram)

- 두 개의 변수를 x와 y의 그래프로 나타내어 , 이들의 분포 정도를 확인
- 표본이 가지는 중심경ㅎ향을 파악한 후, 표본이 분포하고 있는 정도를 나타냄
- 산포도를 나타내는 지표 : 분산, 표준편차, 범위, 사분위수, 백분위수



### 상관계수 유의도 검정

- 상관계수의 통계적 유의성 판단
  - 귀무가설 : 상관계수가 0이다.
  - 대립가설 : 상관계수가 0이 아니다.
  - cor.test(x.y,alternative,)